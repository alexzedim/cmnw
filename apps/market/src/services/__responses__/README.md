# B.net API Response Structure Documentation

This directory contains JSON files documenting the expected structure of Battle.net World of Warcraft API responses for profession-related endpoints. These files are generated by the `pricing.service.spec.ts` test suite.

## Purpose

These response structures serve as:
1. **Type Reference** - Understanding the exact structure of B.net API responses
2. **Interface Development** - Using these structures to create/update TypeScript interfaces
3. **Test Documentation** - Providing examples for mocking and testing
4. **API Change Detection** - Tracking when B.net API response structures change

## Files

### profession-index.json
Response structure for `GET /data/wow/profession/index`

**Contains:** Array of available professions with IDs, names, and links

**Key Fields:**
- `_links` - Self-referential link to endpoint
- `professions[]` - Array of profession objects
  - `id` - Profession ID (number)
  - `name` - Profession name (string)
  - `key` - Link to profession detail endpoint

**Example Usage:**
```typescript
const response = await bnetApi.query<IBnetProfessionIndexResponse>(
  '/data/wow/profession/index',
  { headers: { 'Battlenet-Namespace': 'static-eu' } }
);

const { professions } = response;
// professions is an array of IBnetProfession objects
```

### profession-detail.json
Response structure for `GET /data/wow/profession/{professionId}`

**Contains:** Complete profession information with skill tiers

**Key Fields:**
- `id` - Profession ID
- `name` - Multilingual name object (12 locales)
- `type` - Profession type metadata
- `skill_tiers[]` - Array of skill tier objects
  - `id` - Skill tier ID
  - `tier_number` - Tier number (1-indexed)
  - `minimum_skill_level` - Starting skill requirement
  - `maximum_skill_level` - Maximum skill level for this tier
  - `name` - Multilingual tier name (e.g., "Classic", "The Burning Crusade")

**Multilingual Locales Supported:**
- en_US, en_GB, de_DE, fr_FR, es_ES, es_MX, pt_BR, it_IT, ru_RU, ko_KR, zh_TW, zh_CN

**Example Usage:**
```typescript
const response = await bnetApi.query<IBnetProfessionDetailResponse>(
  '/data/wow/profession/164',  // 164 = Blacksmithing
  { headers: { 'Battlenet-Namespace': 'static-eu' } }
);

const { skill_tiers } = response;
// Iterate through skill tiers to get recipes
for (const tier of skill_tiers) {
  console.log(`${tier.name.en_US}: levels ${tier.minimum_skill_level}-${tier.maximum_skill_level}`);
}
```

### skill-tier-detail.json
Response structure for `GET /data/wow/profession/{professionId}/skill-tier/{skillTierId}`

**Contains:** Recipe categories and recipes for a specific skill tier

**Key Fields:**
- `id` - Skill tier ID
- `tier_number` - Tier number
- `minimum_skill_level` - Starting skill level
- `maximum_skill_level` - Maximum skill level
- `categories[]` - Array of recipe categories
  - `id` - Category ID
  - `name` - Category name (string, not multilingual at this level)
  - `key` - Link to category
  - `recipes[]` - Array of recipe objects
    - `id` - Recipe ID
    - `key` - Link to recipe detail

**Example Usage:**
```typescript
const response = await bnetApi.query<IBnetSkillTierDetailResponse>(
  '/data/wow/profession/164/skill-tier/2396',  // Blacksmithing - Classic
  { headers: { 'Battlenet-Namespace': 'static-eu' } }
);

const { categories } = response;
for (const category of categories) {
  console.log(`Category: ${category.name}`);
  for (const recipe of category.recipes) {
    console.log(`  Recipe ID: ${recipe.id}`);
  }
}
```

### structure-summary.json
High-level summary of all endpoint structures, examples, and metadata

**Contains:**
- Endpoint descriptions and paths
- Field lists for each endpoint
- Multilingual locale support information
- Required headers (e.g., `Battlenet-Namespace`)
- Regional namespace examples (e.g., `static-eu`)

## API Headers

All requests require the `Battlenet-Namespace` header:

```typescript
headers: {
  'Battlenet-Namespace': 'static-eu'  // or 'static-us', 'static-kr', etc.
}
```

The namespace determines which region's data is returned:
- `static-eu` - Europe
- `static-us` - United States
- `static-kr` - Korea
- `static-cn` - China (requires separate credentials)

## Regional Considerations

The provided examples use EU (`static-eu`), but responses are identical across regions except for:
1. Potentially missing professions or tiers in older regions
2. Different expansion availability across regions

## Integration with TypeScript Interfaces

The existing TypeScript interfaces based on these structures are located in:
```
libs/resources/src/types/api/bnet-profession.interface.ts
```

Current interfaces:
- `IBnetProfessionIndexResponse`
- `IBnetProfessionDetailResponse`
- `IBnetSkillTierDetailResponse`

Type aliases for read-only versions:
- `BnetProfessionIndexQueryResponse`
- `BnetProfessionDetailQueryResponse`
- `BnetSkillTierDetailQueryResponse`

## Future Updates

When B.net updates their API:
1. The test will need to be updated with new structures
2. TypeScript interfaces will need updating
3. Compare these JSON files with actual API responses to identify changes
4. Update the pricing service to handle any new fields or structures

## References

- [Battle.net Developer Portal](https://develop.battle.net/)
- [WoW Game Data API Documentation](https://develop.battle.net/documentation/world-of-warcraft/game-data-apis)
